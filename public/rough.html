<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Carousel</title>
  <style>
    .carousel {
      position: relative;
      max-width: 600px;
      margin: 50px auto;
      overflow: hidden;
    }

    /* Slide Transition (default) */
    .carousel-inner {
      display: flex;
      transition: transform 0.5s ease-in-out;
    }

    .carousel-item {
      min-width: 100%;
      box-sizing: border-box;
    }

    /* Uncomment for Fade Transition instead of Slide */
    /*
    .carousel-inner {
        position: relative;
        height: 400px;
    }
    .carousel-item {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
    }
    .carousel-item.active {
        opacity: 1;
    }
    */

    .carousel-item img {
      width: 100%;
      height: auto;
      display: block;
    }

    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      padding: 10px;
      cursor: pointer;
      font-size: 18px;
    }

    .carousel-btn.prev {
      left: 10px;
    }

    .carousel-btn.next {
      right: 10px;
    }

    .carousel-dots {
      text-align: center;
      padding: 10px 0;
    }

    .dot {
      display: inline-block;
      width: 10px;
      height: 10px;
      background: #bbb;
      border-radius: 50%;
      margin: 0 5px;
      cursor: pointer;
    }

    .dot.active {
      background: #333;
    }
  </style>
</head>

<body>
  <div class="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="https://picsum.photos/500/300?random=1" alt="Slide 1">
      </div>
      <div class="carousel-item">
        <img src="https://picsum.photos/500/300?random=2" alt="Slide 2">
      </div>
      <div class="carousel-item">
        <img src="https://picsum.photos/500/300?random=3" alt="Slide 3">
      </div>
    </div>
    <!-- Navigation Buttons -->
    <button class="carousel-btn prev">❮</button>
    <button class="carousel-btn next">❯</button>
    <!-- Dots -->
    <div class="carousel-dots">
      <span class="dot active"></span>
      <span class="dot"></span>
      <span class="dot"></span>
    </div>
  </div>
  <script>
    const carousel = document.querySelector('.carousel-inner');
    const originalItems = document.querySelectorAll('.carousel-item');
    const prevBtn = document.querySelector('.prev');
    const nextBtn = document.querySelector('.next');
    const dots = document.querySelectorAll('.dot');
    const totalItems = originalItems.length;
    let currentIndex = 1; // Start at the first real slide (after the duplicated last slide)
    let autoSlide;

    // Step 1: Duplicate first and last slides for infinite effect
    const firstClone = originalItems[0].cloneNode(true);
    const lastClone = originalItems[totalItems - 1].cloneNode(true);
    carousel.insertBefore(lastClone, originalItems[0]); // Add last slide at start
    carousel.appendChild(firstClone); // Add first slide at end
    const items = document.querySelectorAll('.carousel-item'); // Updated list with clones

    // Step 2: Set initial position to the first real slide
    carousel.style.transform = `translateX(-${currentIndex * 100}%)`;

    // Function to update carousel position without transition (for resets)
    function resetCarousel() {
      carousel.style.transition = 'none'; // Disable transition for instant jump
      carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
      setTimeout(() => {
        carousel.style.transition = 'transform 0.5s ease-in-out'; // Re-enable transition
      }, 0);
    }

    // Function to update carousel with transition
    function updateCarousel() {
      console.log(currentIndex);
      carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
      updateDots();
    }

    // Function to update active dot
    function updateDots() {
      let dotIndex = currentIndex - 1; // Adjust for clones
      if (dotIndex < 0) dotIndex = totalItems - 1;
      if (dotIndex >= totalItems) dotIndex = 0;
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === dotIndex);
      });
    }

    // Handle transition end to reset position seamlessly
    carousel.addEventListener('transitionend', () => {
      if (currentIndex === 0) {
        currentIndex = totalItems; // Jump to last real slide
        resetCarousel();
      } else if (currentIndex === totalItems + 1) {
        currentIndex = 1; // Jump to first real slide
        resetCarousel();
      }
    });

    // Next button
    nextBtn.addEventListener('click', () => {
      currentIndex++;
      updateCarousel();
    });

    // Previous button
    prevBtn.addEventListener('click', () => {
      currentIndex--;
      updateCarousel();
    });

    // Dot navigation
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        currentIndex = index + 1; // Adjust for clone at start
        updateCarousel();
      });
    });

    // Auto-slide
    function startAutoSlide() {
      autoSlide = setInterval(() => {
        currentIndex++;
        updateCarousel();
      }, 3000);
    }

    // Pause auto-slide on hover
    carousel.parentElement.addEventListener('mouseenter', () => clearInterval(autoSlide));
    carousel.parentElement.addEventListener('mouseleave', startAutoSlide);

    // Swipe support
    let startX, moveX;
    carousel.parentElement.addEventListener('touchstart', (e) => {
      startX = e.touches[0].clientX;
    });
    carousel.parentElement.addEventListener('touchmove', (e) => {
      moveX = e.touches[0].clientX;
    });
    carousel.parentElement.addEventListener('touchend', () => {
      if (startX - moveX > 50) {
        currentIndex++;
      } else if (moveX - startX > 50) {
        currentIndex--;
      }
      updateCarousel();
    });

    // Initialize
    startAutoSlide();
    updateDots();
  </script>
</body>

</html>